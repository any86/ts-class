# 为 Vue3 学点 TypeScript, 什么是声明文件(declare)?

## 直达
[第一课, 体验typescript](https://juejin.im/post/5d19ad6de51d451063431864)

[第二课, 基础类型和入门高级类型](https://juejin.im/post/5d1af3426fb9a07ed4411a9b)

[第三课, 什么是泛型?](https://juejin.im/post/5d27f160e51d45108223fcf9)

[第四课, 解读高级类型](https://juejin.im/post/5d3fe80fe51d456206115987)

[第五课, 命名空间(namespace)是什么?](https://juejin.im/post/5d5d04dfe51d4561af16dd24)

## 什么是声明文件?
一句话概括下: **声明文件就是为js代码补充类型标注, 让ts知道js中的变量都是什么类型的.**

## 什么时候需要用?
当你在ts中使用js代码的时候, 比如在ts中引入一个没有声明文件的jssdk.

## 没有声明文件会怎么样?
用`jquery`举例:

![](https://ws1.sinaimg.cn/large/005IQkzXly1g6cuoso4iyj30ov08bjt6.jpg)

系统提示他找不到`jq`的声明文件, 也就不知道`$`的类型(隐含$是`any`类型), 这主要是因为我们在`tsconfig`中开启了"any报警"(noImplicitAny:true和strict:true), 当然你可以关闭他们, 但是你自己的ts代码写的类型标注也就没意义了.

## 声明文件对纯js项目有什么帮助?
如果你用的是**vscode**, 那么他会自动分析js代码, 如果存在对应的声明文件, vscode会把声明文件的内容作为代码提示.
比如`three.js`在安装了声明文件后:

## 我们去哪里找已经写好的声明文件?(@types)
声明文件一般都是以`.d.ts`结尾, 比如jquery.d.ts, 一般比较大牌的第三方js插件在npm上都有对应的声明文件, 比如jquery的声明文件就可以在npm上下载:
```shell
npm i @types/jquery
```

`npm i @types/jquery`中的jquery可以换成任意js库的名字, 当然**前提是有人写了对应的声明文件发布到了npm**, **安装后**, 我们可以在`node_modules/@types/jquery`中的看到声明文件, 这里我打开`mise.d.ts`文件:

![](https://ws1.sinaimg.cn/large/005IQkzXly1g6cwdl2cu9j30nl0c4412.jpg)

如果前面的几节课你都学过了, 你会发现这里出现了一个新的关键词`declare`, 他用来表示他后面定义的变量是全局变量. 此处不多说, 后面会具体讲到.

https://github.com/DefinitelyTyped/DefinitelyTyped/tree/master/types/jquery

## 什么情况下要自己写声明文件?(jssdk)
还记得我刚才说通过npm安装声明文件的前提是"有人写了对应的声明文件发布到了npm", 但是有时候你引入的js库(比如支付类sdk和一些js写的jq特效插件)并没有声明文件, 但是把你还必须引入这个库, 那没办法了自己写吧!


## 如何写声明文件?(7个模板)
首先看过ts文档的同学应该知道ts给出了7种书写声明的模板:
- global-modifying-module.d.ts
- global-plugin.d.ts
- global.d.ts
- module-class.d.ts
- module-function.d.ts
- module-plugin.d.ts
- module.d.ts

这几个模板写的很详细了, 但是很可惜在网上是没有中文解释, 所以下面我给大家解释下每个模板**在什么情况下用/怎么用**.

### global-modifying-module.d.ts
其实我们安装完t**ypescript**, 会自动给我们安装一些系统变量的声明文件, 存在`node_modules/typescript/lib`下.
![](https://ws1.sinaimg.cn/large/005IQkzXly1g6odnyt5bjj30a30e3tac.jpg)


如果你要修改**已存在**的全局变量的声明可以这么写, 下面用node下的`global`举例,
```typescript


```







## declare
"`declare`"这个关键词在很多老牌js库中都可以看到, 比如jq/lodash/three.js等, 声明的内容都写在"xx.d.ts"这样的文件中, 如果你不知道他是干嘛的, 那么下面我将开始为你解惑:



为非ts文件产生的声明文件.
一个声明文件示例.

## 什么时候要写声明文件?

## 写好了放在哪里?

## 怎么写声明文件?
package.json中的types字段

## JQuery的申明文件是怎么样的?
jq的声明文件中有一个`JQueryStatic.d.ts`, 在其中他

### 声明一个全局变量
```typescript
// 这样ts就知道有一个全局变量`n`, 他是`number`类型;
declare var n:number;
n=123


```



## 如何引入声明文件?
```typescript
<reference types="JQuery.d.ts" />
```

## 有什么要注意的?

## 总结
多写多练, 很快就上手, 放几个我用ts写的项目当做参考, 抛砖引玉, 加油!

手势库: https://github.com/any86/any-touch

命令式调用vue组件: https://github.com/any86/vue-create-root

工作中常用的一些代码片段: https://github.com/any86/useful-utils

一个mini的事件管理器: https://github.com/any86/any-event